let isPreview=!1,cloneEl=null,originalEl=null,mask=null,currentScrollTop=0;document.addEventListener("DOMContentLoaded",()=>{Array.from(document.getElementsByClassName("data-image")).forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),originalEl=e.target,cloneEl=originalEl.cloneNode(!0),originalEl.style.opacity=.3,openPreview()})})});function openPreview(){isPreview=!0;const{offsetWidth:e}=originalEl,{top:t,left:n}=originalEl.getBoundingClientRect();mask=document.createElement("div"),mask.classList.add("modal"),document.body.appendChild(mask),mask.addEventListener("click",()=>{cancelScaleImg()}),changeStyle(cloneEl,["transition: transform 0.5s ease;",`left: ${n}px`,`top: ${t}px`,`position: absolute`,`width: ${e}px`]),mask.appendChild(cloneEl),cloneEl.onload=()=>{moveAndScaleImg()},currentScrollTop=window.pageYOffset||document.documentElement.scrollTop}function moveAndScaleImg(){const t=window.innerWidth,n=window.innerHeight,s=originalEl.offsetWidth,o=originalEl.offsetHeight,i=t/s,a=n/o,r=Math.min(i,a),e=originalEl.getBoundingClientRect(),c=(t-e.width)/2-e.left,l=(n-e.height)/2-e.top;changeStyle(cloneEl,[`transform: translate(${c}px, ${l}px) scale(${r-.1})`])}function cancelScaleImg(){const{top:e,left:t}=originalEl.getBoundingClientRect();changeStyle(cloneEl,["transition: transform 0.5s ease;",`left: ${t}px`,`top: ${e}px`,`transform: translate(0,0)`]),setTimeout(()=>{mask.parentNode&&mask.parentNode.removeChild(mask),originalEl.style.opacity=1,mask.removeEventListener("click",cancelScaleImg),isPreview=!1},500)}window.addEventListener("resize",()=>{if(isPreview){const{offsetWidth:e}=originalEl,{top:t,left:n}=originalEl.getBoundingClientRect();changeStyle(cloneEl,[`left: ${n}px`,`top: ${t}px`,`position: absolute`,`width: ${e}px`]),moveAndScaleImg()}}),window.addEventListener("scroll",function(){if(isPreview){let t=window.pageYOffset||document.documentElement.scrollTop,e=Math.abs(t-currentScrollTop);if(e>20){e=0,cancelScaleImg();return}}}),document.addEventListener("keydown",function(e){e.code==="Escape"&&isPreview&&cancelScaleImg()});function changeStyle(e,t){const n=e.style.cssText.split(";");n.pop(),e.style.cssText=n.concat(t).join(";")+";"}